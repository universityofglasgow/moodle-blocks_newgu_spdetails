{"version":3,"file":"assessmenttabs.min.js","sources":["../src/assessmenttabs.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript to initialise the Course Tabs section\n *\n * @module     block_newgu_spdetails/assessmenttabs\n * @author     Greg Pedder <greg.pedder@glasgow.ac.uk>\n * @copyright  2023 University of Glasgow\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n\"use strict\";\n\nimport * as Log from 'core/log';\nimport * as bootstrap from 'core/bootstrap';\nimport * as ajax from \"../../../../lib/amd/src/ajax\";\n\nconst Selectors = {\n    DASHBOARD_BLOCK: '#assessments-Tab'\n};\n\nconst initAssessmentTabs = () => {\n    const triggerTabList = document.querySelectorAll(`#${Selectors.DASHBOARD_BLOCK} button`);\n\n    // Bind our event listeners.\n    triggerTabList.forEach(triggerEl => {\n        triggerEl.addEventListener('click', handleTabChange);\n        triggerEl.addEventListener(\"keyup\", function(event) {\n            let element = document.activeElement;\n            if (event.keyCode === 13 && element.hasAttribute('tabindex')) {\n                event.preventDefault();\n                element.click();\n            }\n        });\n    });\n\n    let activetab = 'current';\n    let page = 0;\n    let sortby = 'coursetitle';\n    let sortorder = 'asc';\n    let isPageClicked = false;\n\n    // Load the assessments for the \"current\" tab to begin with...\n    loadAssessments(activetab, page, sortby, sortorder, isPageClicked);\n};\n\nconst loadAssessments = function(activetab, page, sortby, sortorder, isPageClicked, subcategory = null) {\n    let assessmentContainer = document.querySelector('#assessments-container');\n    let subcategoryContainer = document.querySelector('#subcategory-container');\n    let tabContent = subcategory === null ? document.querySelector('.nav-link.active')\n        : document.querySelector('#subcategory_details_contents');\n\n    if (subcategory === null) {\n        assessmentContainer.classList.remove('hidden-container');\n        subcategoryContainer.classList.add('hidden-container');\n    } else {\n        assessmentContainer.classList.add('hidden-container');\n        subcategoryContainer.classList.remove('hidden-container');\n    }\n\n    let promise = ajax.call([{\n        methodname: 'block_newgu_spdetails_get_assessments',\n        args: {\n            activetab: activetab,\n            page: page,\n            sortby: sortby,\n            sortorder: sortorder,\n            subcategory: subcategory\n        }\n    }]);\n    promise[0].done(function(response) {\n        tabContent.innerHTML = response.result;\n    });\n};\n\n/**\n * Function to bind events to tabs.\n *\n * @param {object} event\n */\nfunction handleTabChange(event) {\n    event.preventDefault();\n    const tabTrigger = new bootstrap.Tab(event.target);\n    Log.debug('found:' + tabTrigger);\n\n    let activetab = event.target.dataset.activetab;\n    let page = 0;\n    let sortby = 'coursetitle';\n    let sortorder = 'asc';\n    let isPageClicked = false;\n\n    loadAssessments(activetab, page, sortby, sortorder, isPageClicked);\n}\n\n\n/**\n * @constructor\n */\nexport const init = () => {\n    initAssessmentTabs();\n};"],"names":["_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","_interopRequireWildcard","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","_exports","value","init","Log","bootstrap","ajax","Selectors","loadAssessments","activetab","page","sortby","sortorder","isPageClicked","subcategory","arguments","length","undefined","assessmentContainer","document","querySelector","subcategoryContainer","tabContent","classList","remove","add","methodname","args","done","response","innerHTML","result","handleTabChange","event","preventDefault","tabTrigger","Tab","target","debug","dataset","querySelectorAll","forEach","triggerEl","addEventListener","element","activeElement","keyCode","hasAttribute","click"],"mappings":"4JA4BqD,SAAAA,yBAAAC,mCAAAC,wBAAAC,sBAAAD,QAAAE,qBAAAF,eAAAF,kCAAAC,oBAAAA,YAAAG,iBAAAD,oBAAAF,aAAA,SAAAI,wBAAAC,IAAAL,iBAAAA,aAAAK,KAAAA,IAAAC,kBAAAD,cAAAA,sBAAAA,wBAAAA,WAAAE,QAAAF,SAAAG,MAAAT,yBAAAC,gBAAAQ,OAAAA,MAAAC,IAAAJ,YAAAG,MAAAE,IAAAL,SAAAM,UAAAC,sBAAAC,OAAAC,gBAAAD,OAAAE,iCAAAC,OAAAX,mBAAAW,KAAAH,OAAAI,UAAAC,eAAAC,KAAAd,IAAAW,UAAAI,KAAAR,sBAAAC,OAAAE,yBAAAV,IAAAW,UAAAI,OAAAA,KAAAV,KAAAU,KAAAC,KAAAR,OAAAC,eAAAH,OAAAK,IAAAI,MAAAT,OAAAK,KAAAX,IAAAW,YAAAL,OAAAJ,QAAAF,IAAAG,OAAAA,MAAAa,IAAAhB,IAAAM,QAAAA,OAJxCE,OAAAC,eAAAQ,uBAAAC,WAAAD,SAAAE,YAEbC,IAAArB,wBAAAqB,KACAC,UAAAtB,wBAAAsB,WACAC,KAAAvB,wBAAAuB,MAEA,MAAMC,0BACe,mBA4BfC,gBAAkB,SAASC,UAAWC,KAAMC,OAAQC,UAAWC,eAAmC,IAApBC,YAAWC,UAAAC,eAAAC,IAAAF,aAAAA,aAAG,KAC1FG,oBAAsBC,SAASC,cAAc,0BAC7CC,qBAAuBF,SAASC,cAAc,0BAC9CE,WAA6B,OAAhBR,YAAuBK,SAASC,cAAc,oBACzDD,SAASC,cAAc,iCAET,OAAhBN,aACAI,oBAAoBK,UAAUC,OAAO,oBACrCH,qBAAqBE,UAAUE,IAAI,sBAEnCP,oBAAoBK,UAAUE,IAAI,oBAClCJ,qBAAqBE,UAAUC,OAAO,qBAG5BlB,KAAKR,KAAK,CAAC,CACrB4B,WAAY,wCACZC,KAAM,CACFlB,UAAWA,UACXC,KAAMA,KACNC,OAAQA,OACRC,UAAWA,UACXE,YAAaA,gBAGb,GAAGc,MAAK,SAASC,UACrBP,WAAWQ,UAAYD,SAASE,WASxC,SAASC,gBAAgBC,OACrBA,MAAMC,iBACN,MAAMC,WAAa,IAAI9B,UAAU+B,IAAIH,MAAMI,QAC3CjC,IAAIkC,MAAM,SAAWH,YAErB,IAAI1B,UAAYwB,MAAMI,OAAOE,QAAQ9B,UAMrCD,gBAAgBC,UALL,EACE,cACG,OACI,GAWtBR,SAAAE,KAFkBA,KA5EOgB,SAASqB,iBAAkB,IAAGjC,oCAGtCkC,SAAQC,YACnBA,UAAUC,iBAAiB,QAASX,iBACpCU,UAAUC,iBAAiB,SAAS,SAASV,OACzC,IAAIW,QAAUzB,SAAS0B,cACD,KAAlBZ,MAAMa,SAAkBF,QAAQG,aAAa,cAC7Cd,MAAMC,iBACNU,QAAQI,WAEd,IAUNxC,gBAPgB,UACL,EACE,cACG,OACI,EA2DA,CACtB"}