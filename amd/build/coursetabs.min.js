define("block_newgu_spdetails/coursetabs",["exports","core/log","../../../../lib/amd/src/ajax","core/notification","core/templates"],(function(_exports,Log,Ajax,_notification,_templates){var obj;function _getRequireWildcardCache(nodeInterop){if("function"!=typeof WeakMap)return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(null===obj||"object"!=typeof obj&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if("default"!==key&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}return newObj.default=obj,cache&&cache.set(obj,newObj),newObj}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,Log=_interopRequireWildcard(Log),Ajax=_interopRequireWildcard(Ajax),_templates=(obj=_templates)&&obj.__esModule?obj:{default:obj};const loadAssessments=function(activetab,page,sortby,sortorder,isPageClicked){let subcategory=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,parent=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,containerBlock=document.querySelector("#course_contents_container"),whichTemplate=null===subcategory?"coursecategory":"coursesubcategory";containerBlock.children.length>0&&(containerBlock.innerHTML=""),containerBlock.insertAdjacentHTML("afterbegin","<div class='loader d-flex justify-content-center'>\n<div class='spinner-border' role='status'><span class='hidden'>Loading...</span></div></div>");let promise=Ajax.call([{methodname:"block_newgu_spdetails_get_assessments",args:{activetab:activetab,page:page,sortby:sortby,sortorder:sortorder,subcategory:subcategory}}]);promise[0].done((function(response){document.querySelector(".loader").remove();let coursedata=JSON.parse(response.result);Log.debug("coursedata:"+response.result),_templates.default.renderForPromise("block_newgu_spdetails/"+whichTemplate,{coursedata:coursedata}).then((_ref=>{let{html:html,js:js}=_ref;_templates.default.appendNodeContents(containerBlock,html,js),1==isPageClicked&&containerBlock.scrollIntoView({behavior:"smooth"});let subCategories=document.querySelectorAll(".subcategory-row"),sortColumns=document.querySelectorAll(".th-sortable");subCategoryEventHandler(subCategories),subCategoryReturnHandler(parent),sortingEventHandler(sortColumns),sortingStatus(sortby,sortorder)})).catch((error=>(0,_notification.exception)(error)))})).fail((function(response){if(response){var errorContainer=document.createElement("div");if(errorContainer.classList.add("alert","alert-danger"),response.hasOwnProperty("message")){var errorMsg=document.createElement("p");errorMsg.innerHTML=response.message,errorContainer.appendChild(errorMsg),errorMsg.classList.add("errormessage")}if(response.hasOwnProperty("moreinfourl")){var errorLinkContainer=document.createElement("p"),errorLink=document.createElement("a");errorLink.setAttribute("href",response.moreinfourl),errorLink.setAttribute("target","_blank"),errorLink.innerHTML="More information about this error",errorContainer.appendChild(errorLinkContainer),errorLinkContainer.appendChild(errorLink),errorLinkContainer.classList.add("errorcode")}containerBlock.prepend(errorContainer)}}))},subCategoryEventHandler=rows=>{rows.length>0&&rows.forEach((element=>{element.addEventListener("click",(()=>showSubcategoryDetails(element)))}))},showSubcategoryDetails=object=>{let id=object.parentElement.getAttribute("data-id"),parent=object.parentElement.getAttribute("data-parent");null!==id&&(document.querySelector("#courseNav-container").classList.add("hidden-container"),loadAssessments("current",0,"duedate","asc",!0,id,parent))},subCategoryReturnHandler=id=>{Log.debug("subCategoryReturnHandler called with id:"+id),null!==id&&document.querySelector("#subcategory-return-assessment").setAttribute("data-parent",id),document.querySelector("#subcategory-return-assessment")&&document.querySelector("#subcategory-return-assessment").addEventListener("click",(()=>{Log.debug("calling loadAssessments with id:"+id),0!=id&&null!==id||(id=null,document.querySelector("#courseNav-container").classList.remove("hidden-container")),loadAssessments("current",0,"coursetitle","asc",!0,id)}))},sortingEventHandler=rows=>{rows.length>0&&rows.forEach((element=>{element.addEventListener("click",(()=>sortingHeaders(element)))}))},sortingHeaders=object=>{let sortby=object.getAttribute("data-sortby"),sortorder=object.getAttribute("data-value");null===sortorder&&(sortorder="asc"),null!==sortorder&&(sortorder="asc"==sortorder?"desc":"asc"),loadAssessments("current",0,sortby,sortorder,!0)},sortingStatus=function(sortby,sortorder){Log.debug("sortingStatus called with sortby:"+sortby+" sortorder:"+sortorder);let sortByCourse=document.querySelector("#sortby_course"),sortByCategoryorComponent=document.querySelector("#sortby_categoryorcomponent"),sortByAssessmentType=document.querySelector("#sortby_assessmenttype"),sortByWeight=document.querySelector("#sortby_weight"),sortByDueDate=document.querySelector("#sortby_duedate");switch(sortby){case"coursetitle":sortByCourse&&("asc"==sortorder?(sortByCourse.classList.add("th-sort-asc"),sortByCourse.classList.remove("th-sort-desc"),sortByCourse.setAttribute("data-value","asc")):(sortByCourse.classList.add("th-sort-desc"),sortByCourse.classList.remove("th-sort-asc"),sortByCourse.setAttribute("data-value","desc")));break;case"categoryorcomponent":sortByCategoryorComponent&&("asc"==sortorder?(sortByCategoryorComponent.classList.add("th-sort-asc"),sortByCategoryorComponent.classList.remove("th-sort-desc"),sortByCategoryorComponent.setAttribute("data-value","asc")):(sortByCategoryorComponent.classList.add("th-sort-desc"),sortByCategoryorComponent.classList.remove("th-sort-asc"),sortByCategoryorComponent.setAttribute("data-value","desc")));break;case"assessmenttype":sortByAssessmentType&&("asc"==sortorder?(sortByAssessmentType.classList.add("th-sort-asc"),sortByAssessmentType.classList.remove("th-sort-desc"),sortByAssessmentType.setAttribute("data-value","asc")):(sortByAssessmentType.classList.add("th-sort-desc"),sortByAssessmentType.classList.remove("th-sort-asc"),sortByAssessmentType.setAttribute("data-value","desc")));break;case"weight":sortByWeight&&("asc"==sortorder?(sortByWeight.classList.add("th-sort-asc"),sortByWeight.classList.remove("th-sort-desc"),sortByWeight.setAttribute("data-value","asc")):(sortByWeight.classList.add("th-sort-desc"),sortByWeight.classList.remove("th-sort-asc"),sortByWeight.setAttribute("data-value","desc")));break;case"duedate":sortByDueDate&&("asc"==sortorder?(sortByDueDate.classList.add("th-sort-asc"),sortByDueDate.classList.remove("th-sort-desc"),sortByDueDate.setAttribute("data-value","asc")):(sortByDueDate.classList.add("th-sort-desc"),sortByDueDate.classList.remove("th-sort-asc"),sortByDueDate.setAttribute("data-value","desc")))}},handleTabChange=function(event){event.preventDefault();let currentTab=document.querySelector("#current_tab"),pastTab=document.querySelector("#past_tab");switch(event.target){case currentTab:var activetab="current",page=0,sortby="coursetitle",sortorder="asc";currentTab.classList.add("active"),pastTab.classList.remove("active"),loadAssessments(activetab,page,sortby,sortorder,false);break;case pastTab:activetab="past",page=0,sortby="coursetitle",sortorder="ASC";currentTab.classList.remove("active"),pastTab.classList.add("active"),loadAssessments(activetab,page,sortby,sortorder,false)}};_exports.init=()=>{loadAssessments("current",0,"coursetitle","asc",!1),document.querySelectorAll("#courses-Tab button").forEach((triggerEl=>{triggerEl.addEventListener("click",handleTabChange),triggerEl.addEventListener("keyup",(function(event){let element=document.activeElement;13===event.keyCode&&element.hasAttribute("tabindex")&&(event.preventDefault(),element.click())}))}))}}));

//# sourceMappingURL=coursetabs.min.js.map