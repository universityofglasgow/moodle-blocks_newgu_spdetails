define("block_newgu_spdetails/coursetabs",["exports","core/log","../../../../lib/amd/src/ajax","core/notification","core/templates"],(function(_exports,Log,Ajax,_notification,_templates){var obj;function _getRequireWildcardCache(nodeInterop){if("function"!=typeof WeakMap)return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(null===obj||"object"!=typeof obj&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if("default"!==key&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}return newObj.default=obj,cache&&cache.set(obj,newObj),newObj}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,Log=_interopRequireWildcard(Log),Ajax=_interopRequireWildcard(Ajax),_templates=(obj=_templates)&&obj.__esModule?obj:{default:obj};const loadAssessments=function(activetab,page,sortby,sortorder,isPageClicked){let subcategory=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,containerBlock=document.querySelector("#course_contents_container"),whichTemplate=null===subcategory?"coursecategory":"coursesubcategory";containerBlock.children.length>0&&(containerBlock.innerHTML=""),containerBlock.insertAdjacentHTML("afterbegin","<div class='loader d-flex justify-content-center'>\n<div class='spinner-border' role='status'><span class='hidden'>Loading...</span></div></div>");let promise=Ajax.call([{methodname:"block_newgu_spdetails_get_assessments",args:{activetab:activetab,page:page,sortby:sortby,sortorder:sortorder,subcategory:subcategory}}]);promise[0].done((function(response){document.querySelector(".loader").remove();let coursedata=JSON.parse(response.result);Log.debug("courses:"+response.result),_templates.default.renderForPromise("block_newgu_spdetails/"+whichTemplate,{coursedata:coursedata}).then((_ref=>{let{html:html,js:js}=_ref;_templates.default.appendNodeContents(containerBlock,html,js);let subCategories=document.querySelectorAll(".subcategory-row");subCategoryEventHandler(subCategories)})).catch((error=>(0,_notification.exception)(error)))}))},subCategoryEventHandler=rows=>{rows.length>0&&rows.forEach((element=>{element.addEventListener("click",(()=>showSubcategoryDetails(element)))}))},showSubcategoryDetails=object=>{let id=object.getAttribute("data-id");Log.debug("showSubcategoryDetails called with id:"+id),null!==id&&loadAssessments("current",0,"duedate","ASC",!1,id)},handleTabChange=function(event){event.preventDefault();let currentTab=document.querySelector("#current_tab"),pastTab=document.querySelector("#past_tab");switch(event.target){case currentTab:var activetab="current",page=0,sortby="coursetitle",sortorder="asc";currentTab.classList.add("active"),pastTab.classList.remove("active"),loadAssessments(activetab,page,sortby,sortorder,false);break;case pastTab:activetab="past",page=0,sortby="coursetitle",sortorder="ASC";currentTab.classList.remove("active"),pastTab.classList.add("active"),loadAssessments(activetab,page,sortby,sortorder,false)}};_exports.init=()=>{loadAssessments("current",0,"coursetitle","ASC",!1),document.querySelectorAll("#courses-Tab button").forEach((triggerEl=>{triggerEl.addEventListener("click",handleTabChange),triggerEl.addEventListener("keyup",(function(event){let element=document.activeElement;13===event.keyCode&&element.hasAttribute("tabindex")&&(event.preventDefault(),element.click())}))}))}}));

//# sourceMappingURL=coursetabs.min.js.map